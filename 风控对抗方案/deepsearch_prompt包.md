# DeepSearch Prompt 包（红队评测中台 + 自动化脚本生成平台）

你是资深质量工程与安全对抗架构研究员。  
请围绕“Web2 + Web3 场景下，建设红队评测中台与自动化脚本生成平台”进行深度研究。

## 当前已知信息基线（必须融合，不可忽略）

以下内容是我方已形成的内部认知，deepsearch 需要在此基础上补盲与纠偏，而不是从零重写：

1. 来自 `自动化脚本生成框架研究.md`
- 已形成四段式框架：`Capture -> Analysis -> Synthesis -> Runtime`。
- 已确认重点能力：操作语义化采集、接口同步捕获、操作-请求因果关联、参数依赖建模、脚本合成与自愈。
- 已有工具分层认知：全栈录制类、协议流量类、开发导向类、自研闭环类。

2. 来自 `浏览器风控反风控技术深度解析.md`
- 已形成多层攻防认知：协议层（TLS/HTTP2/QUIC）、环境层（Canvas/WebGL/API 一致性）、行为层（轨迹与时序）、Web3链上/链下联动。
- 已确认风控侧趋势：主动探测、陷阱机制、跨维一致性校验、身份与经济成本博弈。

3. 来自 `P0P1级别关键技术点深度分析与市场解决方案.md`
- 已有 P0/P1 八个关键技术点分级（CDP、Client Hints、时间一致性、扩展悖论、框架特征、TLS/HTTP2、指纹一致性、JS时序）。
- 已有开源优先与阶段实施认知（分阶段推进、测试矩阵、成本与成功率比较）。

4. 现有策略约束（来自业务决策）
- 开源免费优先，付费方案仅在开源路线连续两轮达不到目标指标时才允许引入。
- 需要同时覆盖 Web2 + Web3。
- 输出必须同时包含：调研结论 + 可执行落地方案。

## deepsearch 必做任务（在回答开头先完成）

1. **已知信息映射表**：把上述 4 组已知信息映射到你的方案结构中，标注“继承/修正/新增”。  
2. **冲突纠偏**：识别现有文档中可能不一致或证据不足的结论，并给出基于官方/GitHub/论文的纠偏意见。  
3. **补盲清单**：明确当前文档没覆盖但落地必须补齐的能力点与实现路径。  

## 全局约束（必须遵守）

1. 主要证据来源仅限：官方文档、GitHub 仓库、论文。  
2. 开源优先：优先给免费开源方案，付费方案仅在不可避免时提出。  
3. 输出必须“研究结论 + 可执行方案”两部分同时具备。  
4. 仅限内部授权评测与质量工程场景，不输出未授权攻击实操细节。  
5. 结果需可落地到现有工作流（CI/CD、日志、追踪、测试平台）。

## 目标

构建一套可执行、可评估、可持续迭代的方案，覆盖：

- 红队评测中台（样本库、评测、回归、报告）
- 自动化脚本生成平台（捕获、分析、生成、自愈）

---

## Prompt 1（总控）

请给出“开源优先 + 工作流可融合”的总体架构蓝图：

- 覆盖捕获、分析、生成、回归四大模块
- 同时兼容 Web2 与 Web3
- 输出架构图（文字化）、模块边界、数据流、依赖关系
- 给出 3 条技术路线：纯开源路线、混合路线、最小付费补位路线
- 每条路线给出适用边界、失败模式、维护成本级别
- 明确哪些部分直接继承我方已知框架（Capture/Analysis/Synthesis/Runtime），哪些部分需要重构

---

## Prompt 2（模块选型）

请按模块给出开源优先选型与替代方案：

1. 捕获模块（用户操作 + 网络接口）
2. 分析模块（因果关联 + 参数建模）
3. 生成模块（脚本合成 + 自愈）
4. 运行模块（回放 + 回归 + 报告）

每个模块必须输出：

- 推荐方案（主）
- 备选方案（2个）
- 淘汰方案（为什么不选）
- 与现有工作流集成方式
- 主要工程风险
- 与我方已知工具认知的对齐结果（保留/替换/新增）

---

## Prompt 3（红队中台）

请设计“红队评测中台”的可执行方案：

- 样本库分层（control / attack-basic / attack-advanced / boundary-legit）
- 样本元数据 schema（字段定义）
- 评测流程 Runbook（从授权到复测闭环）
- 周期性回归机制（daily/weekly/release gate）
- 报告模板（发现、证据、归因、修复建议）

并给出可量化指标：

- 检测命中率、漏报率、误报率
- 解释时长（MTTE）、修复闭环时长（MTTFix）
- 回归退化率
- 指标必须能映射到我方已有 P0/P1 八点分级体系

---

## Prompt 4（脚本生成平台）

请设计“自动化脚本生成平台”的可执行方案：

- 人工操作捕获与接口捕获如何关联
- 参数依赖自动识别与变量化策略
- 脚本输出结构（可维护、可回归）
- 自愈策略（元素变化、流程变化、数据变化）
- 失败场景与降级策略

请重点回答：

- 哪些能力可以纯开源实现？
- 哪些能力短期难以开源稳定实现？
- 如何先做 MVP 再逐步演进？
- 如何复用我方已有“操作-请求因果分析”和“参数依赖建模”认知，避免重复造轮子

---

## Prompt 5（4/8/12周实施）

请输出三档实施计划：

- 4周 MVP
- 8周可用版
- 12周完整版

每档必须包含：

- 目标
- 里程碑
- 任务拆解
- 人员配置
- 交付物
- 验收标准
- 且每档都要标注“利用了哪些现有资产，新增建设了什么”

---

## Prompt 6（指标与验收）

请按以下优先级设计统一评分与验收体系：

1. 脚本生成成功率
2. 回归稳定性
3. 维护成本

输出内容：

- 指标定义公式
- 阈值建议（MVP/可用版/完整版）
- 看板字段
- 指标失真风险与校正方法

---

## Prompt 7（风险与规避）

请输出完整风险清单与规避策略：

- 技术风险
- 数据风险
- 流程风险
- 运行风险

每项需包含：

- 触发条件
- 影响范围
- 监控信号
- 缓解措施
- 回滚策略
- 另外必须输出“文档结论风险等级”：高风险假设/中风险假设/低风险假设

---

## Prompt 8（付费方案启用阈值）

请定义“何时必须引入付费方案”的硬阈值规则：

- 开源方案连续两轮评测未达目标时的判定标准
- 允许引入付费的最小范围（只补齐缺口能力）
- 评估期与退出机制（避免长期锁定）

请输出一份“付费启用决策树”。
- 决策树必须体现：开源方案连续两轮未达目标指标才可进入付费评估。

---

## 输出格式要求（统一）

1. 先给结论摘要（1页内）
2. 再给详细方案
3. 所有关键论点必须附来源链接（官方/GitHub/论文）
4. 最后给“本周可执行清单（按天）”
5. 额外附录：`已知信息融合对照表`（列：已知信息/是否采纳/如何采纳/证据）
